YUI.add("hermes-template-photo-collection",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a=n.helperMissing,f=this.escapeExpression;return u={hash:{},data:i},s+=f((o=n.outlet||t.outlet,o?o.call(t,t["display-collection"],u):a.call(t,"outlet",t["display-collection"],u)))+'\n\n<div class="progress-indicator">\n	<span class="fetching-message">',u={hash:{intlName:"photo-list.FETCHING_PHOTOS"},data:i},s+=f((o=n.intlMessage||t.intlMessage,o?o.call(t,u):a.call(t,"intlMessage",u)))+'</span>\n	<span class="fetching-more-message">',u={hash:{intlName:"photo-list.FETCHING_MORE_PHOTOS"},data:i},s+=f((o=n.intlMessage||t.intlMessage,o?o.call(t,u):a.call(t,"intlMessage",u)))+'</span>\n	<span class="searching-message">',u={hash:{intlName:"photo-list.SEARCHING"},data:i},s+=f((o=n.intlMessage||t.intlMessage,o?o.call(t,u):a.call(t,"intlMessage",u)))+"</span>\n</div>",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/photo-collection",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("search-url",function(e){function s(e){return typeof e=="number"?e.toString():typeof e=="boolean"?e?"1":"0":typeof e=="string"?e:undefined}var t,n,r=/^\/search(?:\/.+)?$/,i=/^bw|blackandwhite$/;YUI.Env.isServer?t=require("querystring").stringify:t=e.QueryString.stringify,n=function(t,r,i){var o,u,a,f,l;this.appContext=r,typeof t=="string"?(l=t.split("?"),i?this.searchType=i:(u=l[0].split("/"),u[0].indexOf("http")!==-1?a=3:a=1,f="/"+u.slice(a).join("/"),this.searchType=this.getSearchTypeFromPathname(f)),l=l.length>1?l[1]:"",this.params=l?e.QueryString.parse(l):{}):(this.params=e.merge(t),this.searchType=i);for(o in this.params)this.params.hasOwnProperty(o)&&(this.params[o]=s(this.params[o]));this.params.color_codes&&(this.colors=this.params.color_codes.toString().split(",")),this.searchType||this.setSearchType(n.searchTypes.UNDEFINED)},n.prototype.setSearchType=function(t){var n=this.getSearchTerm();return this.searchType=t,this.params=this.validateParams(this.params,this.searchType),this.params=e.merge(this.getDefaultParams(this.searchType),this.params),n&&this.setSearchTerm(n),this},n.prototype.getSearchTypeFromPathname=function(e){e=e||this.pathname,e=e.toLowerCase(),e=e.split("/").join("");switch(e){case"searchpeople":return n.searchTypes.PEOPLE;case"searchgroups":return n.searchTypes.GROUPS;case"search":default:return n.searchTypes.PHOTOS}},n.prototype.getPathname=function(){var e="/search/";switch(this.searchType){case n.searchTypes.PEOPLE:e+="people/";break;case n.searchTypes.GROUPS:e+="groups/";break;case n.searchTypes.PHOTOS:default:}return e},n.prototype.validateParams=function(t,r){var i,s={},o,u;t=e.merge(t);switch(r){case n.searchTypes.PEOPLE:i=e.merge(e.SearchHelper.PEOPLE_SEARCH_API),i.text="text";break;case n.searchTypes.GROUPS:i=e.merge(e.SearchHelper.GROUPS_SEARCH_API);break;case n.searchTypes.PHOTOS:i=e.merge(e.SearchHelper.API,e.SearchHelper.UNIFIED_SEARCH_PARAMS);break;case n.searchTypes.UNDEFINED:default:return t}if(i)for(o in i)u=i[o],typeof t[u]!="undefined"&&(s[u]=t[u]);return s},n.prototype.getDefaultParams=function(t){var r={};switch(t){case n.searchTypes.PEOPLE:e.SearchHelper.addPeopleParamDefaults(r);break;case n.searchTypes.GROUPS:e.SearchHelper.addGroupsParamDefaults(r);break;case n.searchTypes.PHOTOS:e.SearchHelper.addParamDefaults(r);break;case n.searchTypes.UNDEFINED:default:}return r},n.prototype.getAPIParams=function(){return e.merge(this.params)},n.prototype.getAPIParam=function(e){return this.params[e]},n.prototype.setAPIParam=function(e,t){return this.params[e]=s(t),this},n.prototype.removeAPIParam=function(e){return delete this.params[e],this},n.prototype.removeAllAPIParams=function(){return this.params={},this},n.prototype.getSearchTerm=function(){var t=this.params[this.getSearchTermKey(this.searchType)];return t||(t=this.params[e.SearchHelper.API.tags]),t||""},n.prototype.setSearchTerm=function(t){var n=this.getSearchTermKey(this.searchType);return delete this.params[e.SearchHelper.PEOPLE_SEARCH_API.username],delete this.params[e.SearchHelper.GROUPS_SEARCH_API.text],delete this.params[e.SearchHelper.API.text],this.params[n]=t,this},n.prototype.getSearchTermKey=function(t){switch(t){case n.searchTypes.PEOPLE:return e.SearchHelper.PEOPLE_SEARCH_API.username;case n.searchTypes.GROUPS:return e.SearchHelper.GROUPS_SEARCH_API.text;case n.searchTypes.PHOTOS:default:return this.params[e.SearchHelper.API.tags]?e.SearchHelper.API.tags:e.SearchHelper.API.text}},n.prototype.removeScope=function(){return e.SearchHelper.SEARCH_SCOPE_PARAMS.forEach(function(e){this.removeAPIParam(e)}.bind(this)),this},n.prototype.resetToUnified=function(){return this.params[e.SearchHelper.UNIFIED_SEARCH_PARAMS.viewAll]&&(this.removeAPIParam(e.SearchHelper.API.userId),this.removeAPIParam(e.SearchHelper.API.contacts)),this.removeAPIParam(e.SearchHelper.UNIFIED_SEARCH_PARAMS.viewAll),this},n.prototype.resetAdvancedParam=function(){var t;return t=Object.keys(e.SearchHelper.API).some(function(t){if(t!==e.SearchHelper.API.text&&t!==e.SearchHelper.API.sort&&e.SearchHelper.SEARCH_SCOPE_PARAMS.indexOf(t)===-1&&!e.SearchHelper.UNIFIED_SEARCH_PARAMS.hasOwnProperty(t)&&this.params.hasOwnProperty(t))return!0},this),t?this.setAPIParam(e.SearchHelper.UNIFIED_SEARCH_PARAMS.advanced,1):this.removeAPIParam(e.SearchHelper.UNIFIED_SEARCH_PARAMS.advanced),this},n.prototype.createNewSearch=function(e){this.setSearchTerm(e);if(this.searchType===n.searchTypes.UNDEFINED||this.searchType===n.searchTypes.PHOTOS)this.removeScope(),this.resetToUnified(),this.resetAdvancedParam();return this},n.prototype.getURL=function(){var e=this.getId(),t=this.getPathname();return e===n.EMPTY_SEARCH_ID?t:t+"?"+e},n.prototype.getId=function(){var r={},i,s=e.SearchHelper.API;for(i in this.params)s[i]?r[s[i]]=this.params[i]:r[i]=this.params[i];return t(r)||n.EMPTY_SEARCH_ID},n.prototype.clone=function(){var e=new n(this.params,this.appContext,this.searchType);return e},n.prototype.setMedia=function(t,n){var r;t||(t=!1),n||(n=!1),t&&n?r="all":t?r="photos":r="videos",this.setAPIParam(e.SearchHelper.API.mediaType,r)},n.prototype._syncColors=function(){this.colors&&this.colors.length>0?this.params.color_codes=this.colors.join(","):this.removeAPIParam("color_codes")},n.prototype.addColorCode=function(e){if(e&&e.match(i)){this.clearColorCodes(),this.colors=["bw"],this._syncColors();return}this.colors&&this.colors.indexOf("bw")!==-1&&(this.colors=[]),this.colors||(this.colors=[]),this.colors.indexOf(e)===-1&&(this.colors.push(e),this._syncColors())},n.prototype.removeColorCode=function(e){var t;this.colors&&(t=this.colors.indexOf(e),t!==-1&&(this.colors.splice(t,1),this._syncColors()))},n.prototype.clearColorCodes=function(){this.colors=[],this._syncColors()},n.isSearchUrl=function(e){return r.test(e)},n.searchTypes={UNDEFINED:0,PHOTOS:1,PEOPLE:2,GROUPS:3},n.EMPTY_SEARCH_ID="-1",e.SearchUrl=n},"@VERSION@",{requires:["search-helper","querystring-parse-simple","querystring-stringify-simple"]});
YUI.add("photo-lite-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{update:e.PhotoModelHelper.updateEngagement},toggleFave:e.PhotoModelHelper.toggleFave,addAsFave:e.PhotoModelHelper.addAsFave,getLargestSize:e.PhotoModelHelper.getLargestSize,getSizeToFit:e.PhotoModelHelper.getSizeToFit,getSizeIfExact:e.PhotoModelHelper.getSizeIfExact,isSizeSquare:e.PhotoModelHelper.isSizeSquare,isPhotoSquare:e.PhotoModelHelper.isPhotoSquare,attributes:{owner:{readOnly:!0,isModel:!0,getter:function(e,t){var n=this;return{getValue:function(e){return e==="id"?n.getValue(t,"ownerNsid"):e==="url"?n.getValue(t,"ownerUrl"):n.getValue(t,e)},toJSON:function(){return{id:n.getValue(t,"ownerNsid"),url:n.getValue(t,"ownerUrl"),pathAlias:n.getValue(t,"pathAlias"),username:n.getValue(t,"username"),realname:n.getValue(t,"realname"),displayname:n.getValue(t,"displayname"),nsid:n.getValue(t,"ownerNsid"),ownerUrl:n.getValue(t,"ownerUrl"),isMe:n.getValue(t,"isMe")}}}}},pathAlias:e.PersonModelHelper.attributes.pathAlias,username:e.PersonModelHelper.attributes.username,realname:e.PersonModelHelper.attributes.realname,displayname:e.PersonModelHelper.attributes.displayname,nsid:e.PersonModelHelper.attributes.nsid,ownerUrl:e.PersonModelHelper.attributes.url,isMe:e.PersonModelHelper.attributes.isMe,engagement:{readOnly:!0,isModel:!0,getter:function(e,t){var n=this;return{getValue:function(e){return n.getValue(t,e)},toJSON:function(){return{ownerNsid:n.getValue(t,"ownerNsid"),isFaved:n.getValue(t,"isFaved"),faveCount:n.getValue(t,"faveCount"),commentCount:n.getValue(t,"commentCount"),canFave:n.getValue(t,"canFave")}}}}},ownerNsid:e.PhotoModelHelper.attributes.ownerNsid,isFaved:e.PhotoModelHelper.attributes.isFaved,faveCount:e.PhotoModelHelper.attributes.faveCount,commentCount:e.PhotoModelHelper.attributes.commentCount,canFave:e.PhotoModelHelper.attributes.canFave,title:e.PhotoModelHelper.attributes.title,mediaType:e.PhotoModelHelper.attributes.mediaType,isVideo:e.PhotoModelHelper.attributes.isVideo,isOwner:e.PhotoModelHelper.attributes.isOwner,sizes:e.PhotoModelHelper.attributes.sizes,descendingSizes:e.PhotoModelHelper.attributes.descendingSizes,ascendingSizes:e.PhotoModelHelper.attributes.ascendingSizes,aspectRatio:e.PhotoModelHelper.attributes.aspectRatio,needsInterstitial:e.PhotoModelHelper.attributes.needsInterstitial,canComment:e.PhotoModelHelper.attributes.canComment,url:e.PhotoModelHelper.attributes.url,rotation:e.PhotoModelHelper.attributes.rotation}})},"@VERSION@",{requires:["flickr-model-registry","photo-model-helper","person-model-helper","flickr-favorites-add-updater","flickr-favorites-remove-updater","photo-models","photo-engagement-models","person-models"]});
YUI.add("search-photos-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ListFetchers["flickr-photos-search"].run(t,this.appContext)}},attributes:{photos:{isCollection:!0,pageFetch:{listFetcher:e.ListFetchers["flickr-photos-search"],listItemIdField:"photoId"}},totalItems:{setter:function(t){return t=e.AttributeHelpers.coerceInteger(t),t<0&&(t=0),t},defaultValue:0},apiParams:{writeOnce:"initOnly"},emptyQuery:{defaultValue:!1}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-photos-search-fetcher"]});
YUI.add("flickr-photos-search-fetcher",function(e,t){"use strict";function n(t){var n={extras:e.APIHelper.request[t.getPhotoLiteModels?"getRebootSearchPhotoExtras":"getRebootPhotoExtras"](),per_page:t.perPage||e.SearchHelper.FETCH_PAGE_SIZE,page:t.page||"1",content_type:t.content_type||"7"},r;return t.fetchGeo&&(n.extras+=",geo"),r=e.merge(n,t.apiParams||{}),YUI.Env.isServer&&e.SearchHelper.unescapeParameters(r),e.SearchHelper.isParameterlessSearch(r)?null:r}function r(t,n){var r=t[0],i=t[1],s=t[2],o,u,a,f={id:n.id||e.SearchUrl.EMPTY_SEARCH_ID,apiParams:{},emptyQuery:!!n.emptyQuery,photos:[]},l,c,h;n.id&&n.id!==e.SearchUrl.EMPTY_SEARCH_ID&&(f.apiParams=e.QueryString.parse(n.id));if(!n.id)throw new ReferenceError("No `id` provided by request.");if(!r.photos||!r.photos.photo)throw new Error("No `photos.photo` property returned by API.");return n.getPhotoLiteModels?a=r.photos.photo.map(function(t){var n=t.pathalias||t.owner;return c={id:t.id,pathAlias:n,username:t.ownername,realname:t.realname,nsid:t.owner,ownerNsid:t.owner,isFaved:t.isfavorite||!1,faveCount:t.countFaves,commentCount:t.countComments,title:t.title,mediaType:t.media,sizes:e.APIHelper.response.parsePhotoSize(t),needsInterstitial:t.needsInterstitial,canComment:t.canComment},s.exists(c.id)||s.add(c),s.proxy(c.id)}):(a=e.APIHelper.response.parsePhotos({photos:r.photos.photo,photoModelRegistry:s,personModelRegistry:t[3],photoEngagementModelRegistry:t[4],photoStatsModelRegistry:t[5]}),n.fetchGeo&&(o=t[6],r.photos.photo.forEach(function(e){typeof e.latitude!="undefined"?l={id:e.id,hasGeo:!0,latitude:e.latitude,longitude:e.longitude}:l={id:e.id,hasGeo:!1},o.exists(l.id)||o.add(l)}))),f.photos={perPage:r.photos.perpage,page:r.photos.page||1,pageContent:a,totalItems:r.photos.total,totalPages:r.photos.pages},f.totalItems=r.photos.total,i.exists(f.id)?(u=i.getValue(f.id,"photos").getList(),h=u.reduce(function(e,t){return e[t.id]=!0,e},{}),f.photos.pageContent=f.photos.pageContent.filter(function(e){return!h[e.id]}),f.photos.page===1&&(f.photos.forceAppend=!0),i.setValue(f.id,"photos",f.photos)):i.add(f),f.photos.pageContent}function i(n,r){var i=this,s="flickr.photos.search",o=n.emptyQuery?{}:this._processParams(n),u;return o||(n.emptyQuery=!0),u=[n.emptyQuery?e.Promise.resolve({photos:{photo:[]}}):r.callAPI(s,o)],n.getPhotoLiteModels?u=u.concat([r.getModelRegistry("search-photos-lite-models"),r.getModelRegistry("photo-lite-models")]):u=u.concat([r.getModelRegistry("search-photos-models"),r.getModelRegistry("photo-models"),r.getModelRegistry("person-models"),r.getModelRegistry("photo-engagement-models"),r.getModelRegistry("photo-stats-models"),r.getModelRegistry("photo-geo-models")]),e.Promise.all(u).then(function(e){return i._processResponse(e,n)},e.FetcherErrorLogger(t))}e.namespace("ListFetchers")["flickr-photos-search"]={run:i,_processParams:n,_processResponse:r}},"@VERSION@",{requires:["flickr-promise","type-validator","search-helper","search-url","api-helper","querystring-parse-simple"],optional:["search-photos-models","search-photos-lite-models","photo-models","photo-lite-models","person-models","photo-engagement-models","photo-stats-models","photo-geo-models"]});
YUI.add("search-photos-lite-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return t.getPhotoLiteModels=!0,e.ListFetchers["flickr-photos-search"].run(t,this.appContext)}},attributes:{photos:{isCollection:!0,pageFetch:{fetchParams:{getPhotoLiteModels:!0},listFetcher:e.ListFetchers["flickr-photos-search"],listItemIdField:"photoId"}},totalItems:{setter:function(t){return t=e.AttributeHelpers.coerceInteger(t),t<0&&(t=0),t},defaultValue:0},apiParams:{writeOnce:"initOnly"},emptyQuery:{defaultValue:!1}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-photos-search-fetcher","attribute-helpers"]});
YUI.add("search-photos-collection-view",function(e){e.namespace("Views")[this.name]=e.Base.create("search-photos-collection-view",e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.searchId=e.searchId,this.paft=e.paft,this},loadState:function(){var t=this,n;return n={appContext:this.appContext,container:this.get("container").one(".display-collection-justified"),beaconViews:this.appContext.getViewCounter({flushDelay:6e4}),canvas:"screen",displayItemExtras:{}},this.paft&&(n.displayItemExtras.paft=!0),this.displayCollection=new e.DisplayCollectionJustified(n),this.searchId?this.appContext.getModel("search-photos-models",this.searchId).then(function(n){return t.searchModel=n,t.searchCollection=new e.CollectionPaginator(n,"photos",{fetchPageSize:e.SearchHelper.FETCH_PAGE_SIZE}),t.searchCollection.passAttributesToFetcher("apiParams"),t.registerSubview(t.displayCollection),t.displayCollection.appendCollection(t.searchCollection),t.displayCollection.initialize()}):e.Promise.resolve()},buildContainer:function(){var e=this;return e.setContainerHTML(e.templates("photo-collection")({"display-collection":e.displayCollection,paft:e.paft})),this.displayCollection.positionFromHistory(),this},activate:function(){return this.registerEventHandler(this.displayCollection.on("bottom",function(e){this.searchModel.getValue("photos").fetchedEnd||this.displayLoadingIndicator("fetching-more")},this)),this.registerEventHandler(this.get("container").delegate("click",this.injectPhotolistContext.bind(this),"a")),this},displayLoadingIndicator:function(e){var t=this.get("container").one(".progress-indicator");t.addClass(e),t.addClass("progress-loading"),this.registerEventHandler(this.displayCollection.on("rendered",function(n){t.removeClass(e),t.removeClass("progress-loading")}))},injectPhotolistContext:function(t){var n=t.currentTarget.getAttribute("href"),r=e.URLHelper.PHOTOPAGE_PATTERN.exec(n),i,s,o,u;r&&r.length>=5&&(i=this.searchCollection.getCurrentPageAsList().map(function(e){return e.id}),s=i.indexOf(r[4]),o=i.slice(i).slice(s,s+50),o.length<50&&(o=i.slice(s-(50-o.length),s).concat(o)),u=n+"/in/photolist-"+e.URLHelper.generateShortenedPhotolist(o),t.halt(),e.rapidTracker.beacon(this.name,"searchPhotoResultClick",{vespaRnk:s+1}),this.appContext.lang.toLowerCase()==="en-us"?this.appContext.flapp.navigate(u):window.location=u)}})},"@VERSION@",{requires:["flutil","flickr-view","flickr-promise","collection-paginator","display-collection-justified","hermes-template-photo-collection","photo-collection-css","url-helper","search-helper"],optional:["search-photos-models"],langBundles:["search","photo-list"]});
YUI.add("hermes-lang-search",function(e,t){e.Intl.add("hermes/search","en-US",{RELEVANT:["Relevant"],RECENT:["Recent"],INTERESTING:["Interesting"],NAME:["Name"],ACTIVITY:["Activity"],SIZE:["Size"],OLDEST:["Oldest"],NEWEST:["Newest"],DEFAULT_SEARCH:['This is where you search Flickr. Here\'s a search for <span class="default-search">',"${query}","</span> to get you started!"],FLICKR_SEARCH:["Flickr Search"],NO_MATCHES_FOR_QUERY_TERM:["Oops! There are no matches for \u201c","${searchTerm}","\u201d."],NO_MATCHES_FOR_QUERY_TERM_WITH_SETTINGS:["Oops! There are no matches for \u201c","${searchTerm}","\u201d with your selected settings."],NO_MATCHES_FOR_QUERY:["Oops! There are no matches for your search."],TRY_DIFFERENT:["Please try refining your search."],TRY_DIFFERENT_BROADER:["Please try broadening your search."],SEARCH_ERROR:["Oops! The date you entered does not exist."],SEARCH_START:["Start your search"],SEARCHING:["Searching"],FETCHING_PHOTOS:["Fetching more photos..."],SEARCH:["Search"],START_YOUR_SEARCH:["Start your search"],BY_USER:["by ","${user}"],NO_MATCHES_FOR_QUERY_TERM_CONTEXT_YOUR:["Oops! There are no matches for \u201c","${searchTerm}","\u201d in your photos."],NO_MATCHES_FOR_QUERY_TERM_CONTEXT_CONTACTS:["Oops! There are no matches for \u201c","${searchTerm}","\u201d in your contacts' photos."],NO_MATCHES_FOR_QUERY_TERM_CONTEXT_USER:["Oops! There are no matches for \u201c","${searchTerm}","\u201d in this user's photos."],NO_MATCHES_FOR_QUERY_TERM_CONTEXT_GROUP:["Oops! There are no matches for \u201c","${searchTerm}","\u201d in this group."],NO_MATCHES_FOR_QUERY_TERM_YOUR:["Oops! There are no matches for your search in your photos."],NO_MATCHES_FOR_QUERY_TERM_CONTACTS:["Oops! There are no matches for your search in your contacts' photos."],NO_MATCHES_FOR_QUERY_TERM_USER:["Oops! There are no matches for your search in this user's photos."],NO_MATCHES_FOR_QUERY_TERM_GROUP:["Oops! There are no matches for your search in this group."],API_ERROR_HEADER:["Oh noes! We couldn't process your search."],API_ERROR_SUBHEADER:["Please change it up a bit and try again."],PEOPLE_YOU_FOLLOW:["People you follow"],ALL_FLICKR_MEMBERS:["All Flickr members"],FLICKR_MEMBERS:["Flickr members"],YOUR_GROUPS:["Your groups"],ALL_FLICKR_GROUPS:["All Flickr groups"],FLICKR_GROUPS:["Flickr groups"],MEMBER_COUNT:[{type:"plural",valueName:"count",options:{zero:"0 members",one:"${#} member",other:"${#} members"}}],GROUP_PHOTO_COUNT:[{type:"plural",valueName:"count",options:{zero:"no photos",one:"${#} photo",other:"${#} photos"}}],GROUP_DISCUSSION_COUNT:[{type:"plural",valueName:"count",options:{zero:"no discussions",one:"${#} discussion",other:"${#} discussions"}}],YOUR_PHOTOS:["Your photos"],YOUR_ALBUMS:["Your albums"],YOUR_GALLERIES:["Your galleries"],FROM_YOUR_CONTACTS:["From your contacts"],EVERYONES_PHOTOS:["Everyone's photos"],VIEW_ALL_COUNT:[{type:"plural",valueName:"count",options:{zero:"no more photos",other:"View all ${#}"}}],RESULTS_COUNT:[{type:"plural",valueName:"count",options:{zero:"no results",one:"${#} result",other:"${#} results"}}],PEOPLE_PHOTOS_COUNT:[{type:"plural",valueName:"count",options:{zero:"0 photos",one:"${#} photo",other:"${#} photos"}}],PEOPLE_VIDEOS_COUNT:[{type:"plural",valueName:"count",options:{zero:"no videos",one:"${#} video",other:"${#} videos"}}],PEOPLE_FOLLOWERS_COUNT:[{type:"plural",valueName:"count",options:{zero:"no followers",one:"${#} follower",other:"${#} followers"}}],SAFESEARCH_ON:["SafeSearch on"],SAFESEARCH_OFF:["SafeSearch off"],SAFESEARCH_MODERATE:["SafeSearch moderate"],ANY_LICENSE:["Any license"],ALL_CC:["All creative commons"],COMMERCIAL_USE:["Commercial use allowed"],MODS_ALLOWED:["Modifications allowed"],COMMERCIAL_USE_MODS:["Commercial use & mods allowed"],NO_RESTRICTIONS:["No known copyright restrictions"],US_GOVT:["U.S. Government works"],PLAIN_COUNT:[{type:"plural",valueName:"count",options:{zero:"0",one:"${#}",other:"${#}"}}],PHOTOS:["Photos"],PHOTOS_POSSESSIVE:["${name}","'s photos"],FAVES_POSSESSIVE:["${name}","'s faves"],CONTACTS_POSSESSIVE:["${name}","'s contacts"],VIEWER_FAVES:["Your faves"],IN_GROUP_POOL:["In the ","${name}"," group pool"],OPT_OUT_MESSAGE:["You are viewing the alpha version of our new search experience. Click here to return to the old version."],OPT_IN_MESSAGE:["Go back to the alpha search experience"],SEARCH_BETA_LABEL:["Search beta"],SEARCH_ALPHA_LABEL:["Search alpha"],GO_BACK_TO_OLD_SEARCH:["Go back to the old Flickr search"],PROVIDE_FEEDBACK:["Provide feedback"],FROM_PEOPLE_YOU_FOLLOW:["From people you follow"],FULL_TEXT_AND_TAGS:["Full text with suggested tags"],FULL_TEXT:["Full text"],TAGS_ONLY:["Tags only"],RED:["red"],DARK_ORANGE:["dark orange"],ORANGE:["orange"],SCHOOL_BUS_YELLOW:["school bus yellow"],LEMON_YELLOW:["lemon yellow"],GREEN:["green"],LIME_GREEN:["dark lime green"],CYAN:["cyan"],BLUE:["blue"],VIOLET:["violet"],PINK:["pink"],PALE_PINK:["pale pink"],WHITE:["white"],GRAY:["gray"],BLACK:["black"],MONOCHROME:["monochrome"],ADVANCED:["Advanced"],ORIENTATION_AND_SIZE:["Orientation & size"],ORIENTATION:["Orientation"],MINIMUM_SIZE:["Minimum size"],PORTRAIT:["Portrait"],SQUARE:["Square"],LANDSCAPE:["Landscape"],PANORAMA:["Panorama"],ALL_SIZES:["All sizes"],MEDIUM:["Medium"],LARGE:["Large"],CUSTOM:["Custom"],COLOR:["Color"],DATE:["Date"],FROM:["From"],TO:["To"],DATE_TAKEN:["Date taken"],DATE_POSTED:["Date posted"],CONTENT:["Content"],VIDEOS:["Videos"],SCREENSHOTS:["Screenshots"],ILLUSTRATIONS:["Illustrations"],SEARCH_IN:["Search in"],RESET:["Reset"]})},"@VERSION@",{requires:["intl"]});
YUI.add("hermes-lang-photo-list",function(e,t){e.Intl.add("hermes/photo-list","en-US",{FETCHING_PHOTOS:["Fetching photos..."],FETCHING_MORE_PHOTOS:["Fetching more photos..."],SEARCHING:["Searching..."]})},"@VERSION@",{requires:["intl"]});
YUI.add("hermes-template-footer-full",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function p(e,t){var r="",i;r+="\n	",i=n["if"].call(e,e.showOptOutBanner,{hash:{},inverse:c.noop,fn:c.program(2,d,t),data:t});if(i||i===0)r+=i;return r+="\n",r}function d(e,t){var r="",i;r+='\n		<div class="group-centered-content groups-opt-out">\n			<form action="/help/optin" method="post">\n				',i=n.each.call(e,e.optOutFlippers,{hash:{},inverse:c.noop,fn:c.program(3,v,t),data:t});if(i||i===0)r+=i;return r+='\n				<input type="hidden" name="redirect_url" value="',(i=n.pageUrl)?i=i.call(e,{hash:{},data:t}):(i=e.pageUrl,i=typeof i===f?i.apply(e):i),r+=l(i)+'">\n				<input type="hidden" name="csrf" value="',(i=n.csrf)?i=i.call(e,{hash:{},data:t}):(i=e.csrf,i=typeof i===f?i.apply(e):i),r+=l(i)+'">\n				<div class="optout-toggle">\n					<span class="label-beta">Beta</span>\n					<button></button>\n					<span class="divider"></span>\n					<a href="https://www.flickr.com/help/forum/en-us/72157645851675914/" target="_new"><i class="feedback">&nbsp;</i></a>\n				</div>\n			</form>\n		</div>\n	',r}function v(e,t){var r="",i;return r+='\n					<input type="hidden" name="',(i=n.name)?i=i.call(e,{hash:{},data:t}):(i=e.name,i=typeof i===f?i.apply(e):i),r+=l(i)+'" value="',(i=n.value)?i=i.call(e,{hash:{},data:t}):(i=e.value,i=typeof i===f?i.apply(e):i),r+=l(i)+'">\n				',r}function m(e,t){var n="",r;return n+='\n					<li class="foot-li lang-switcher">\n						<a href="/change_language.gne?lang='+l((r=(r=e.selectedLang,r==null||r===!1?r:r.code),typeof r===f?r.apply(e):r))+"&csrf="+l((r=(r=e.selectedLang,r==null||r===!1?r:r.csrf),typeof r===f?r.apply(e):r))+'">'+l((r=(r=e.selectedLang,r==null||r===!1?r:r.name),typeof r===f?r.apply(e):r))+'</a>\n						<span class="arrow"></span>\n					</li>\n					',n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f="function",l=this.escapeExpression,c=this,h=n.helperMissing;o=n.unless.call(t,t.hideOptOutBanner,{hash:{},inverse:c.noop,fn:c.program(1,p,i),data:i});if(o||o===0)s+=o;s+='\n\n<footer class="foot">\n	<div class="foot-container centered-content">\n		<div class="foot-top-row">\n			<div class="foot-nav pure-menu-horizontal">\n				<ul class="foot-nav-ul">\n					<li class="foot-li"><a href="/about">',a={hash:{intlName:"common.ABOUT"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):h.call(t,"intlMessage",a)))+'</a></li>\n					<li class="foot-li"><a href="/jobs">',a={hash:{intlName:"common.JOBS"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):h.call(t,"intlMessage",a)))+'</a></li>\n					<li class="foot-li"><a href="//blog.flickr.net/en">',a={hash:{intlName:"common.BLOG"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):h.call(t,"intlMessage",a)))+'</a></li>\n					<li class="foot-li"><a href="//mobile.yahoo.com/flickr">',a={hash:{intlName:"common.MOBILE"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):h.call(t,"intlMessage",a)))+'</a></li>\n					<li class="foot-li"><a href="/services/developer">',a={hash:{intlName:"common.DEVELOPERS"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):h.call(t,"intlMessage",a)))+'</a></li>\n					<li class="foot-li"><a href="/help/guidelines">',a={hash:{intlName:"common.GUIDELINES"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):h.call(t,"intlMessage",a)))+'</a></li>\n					<li class="foot-li"><a href="//yahoo.uservoice.com/forums/211185-us-flickr">',a={hash:{intlName:"common.FEEDBACK"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):h.call(t,"intlMessage",a)))+'</a></li>\n					<li class="foot-li"><a href="/abuse">',a={hash:{intlName:"common.REPORT_ABUSE"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):h.call(t,"intlMessage",a)))+'</a></li>\n					<li class="foot-li"><a href="/help/forum">',a={hash:{intlName:"common.HELP_FORUM"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):h.call(t,"intlMessage",a)))+"</a></li>\n\n					",a={hash:{},inverse:c.noop,fn:c.program(5,m,i),data:i},u=(o=n.isFlipped||t.isFlipped,o?o.call(t,t.flippers,"enable-footer-lang",a):h.call(t,"isFlipped",t.flippers,"enable-footer-lang",a));if(u||u===0)s+=u;return s+='\n				</ul>\n			</div>\n		</div>\n		<div class="pure-g foot-info foot-bottom-row">\n			<div class="pure-u-1-3 foot-yahoo">\n				<ul class="pure-menu-horizontal">\n					<li class="foot-li"><a href="//info.yahoo.com/privacy/us/yahoo/flickr/details.html">',a={hash:{intlName:"common.PRIVACY"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):h.call(t,"intlMessage",a)))+'</a></li>\n					<li class="foot-li"><a href="/help/terms">',a={hash:{intlName:"common.TERMS"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):h.call(t,"intlMessage",a)))+'</a></li>\n					<li class="foot-li"><a href="//safely.yahoo.com">',a={hash:{intlName:"common.YAHOO_SAFELY"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):h.call(t,"intlMessage",a)))+'</a></li>\n					<li class="foot-li"><a href="//help.yahoo.com/kb/flickr">',a={hash:{intlName:"common.HELP"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):h.call(t,"intlMessage",a)))+'</a></li>\n				</ul>\n			</div>\n\n			<div class="pure-u-1-3 foot-company">\n				',a={hash:{intlName:"common.A_YAHOO_COMPANY_WITH_LINK"},data:i},s+=l((o=n.intlHTMLMessage||t.intlHTMLMessage,o?o.call(t,a):h.call(t,"intlHTMLMessage",a)))+'\n			</div>\n\n			<div class="pure-u-1-3 foot-social">\n				<ul class="pure-menu-horizontal">\n					<li><a class="ft-icon hide-text ft-tumblr" href="http://flickr.tumblr.com/">Tumblr</a></li>\n					<li><a class="ft-icon hide-text ft-facebook" href="https://www.facebook.com/flickr">Facebook</a></li>\n					<li><a class="ft-icon hide-text ft-twitter" href="https://twitter.com/flickr">Twitter</a></li>\n					'+'\n					<li><a class="ft-icon hide-text ft-googleplus" href="https://plus.google.com/+flickr">Google Plus</a></li>\n				</ul>\n			</div>\n		</div>\n	</div>\n</footer>\n',s}),r={};e.Array.each([],function(t){
var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/footer-full",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("dropdown",function(e){"use strict";var t,n;t={css:{closed:"ui-dropdown-closed",shim:"ui-dropdown-shim",label:'span[data-action="toggle"]',items:"[data-value]",itemSelected:"ui-dropdown-item-selected",hasDialogArrow:"ui-dropdown-has-dialog-arrow",dialogArrow:"ui-dialog-arrow",useCheckMarks:"ui-dropdown-use-checkboxes"},options:{hasDialogArrow:!1,useCheckMarks:!1}},e.namespace("Views").Dropdown=n=e.Base.create("Dropdown",e.FlickrView,[],{initializer:function(e){if(e.activate===!1)return;this.activate()},activate:function(){var n=this,r=this.get("container"),i;this.close(),this._items={},e.Lang.isArray(this.get("selected"))||this.set("selected",[this.get("selected")]),r.all(t.css.items).each(function(e){var t=e.getData();n._items[t.value]={text:t.text||'no data-text for "'+t.value+'"',sub:t.sub,node:e}}),this.labelEl=r.one(t.css.label),this.labelEl||(this.labelEl=e.Node.create('<span class="truncate" data-action="toggle" />'),r.insert(this.labelEl,0)),i=this.get("staticLabel")||this.get("defaultLabel"),i&&(i===!0?this.labelEl.set("text","set staticLabel/defaultLabel to a string, not `true`"):this.labelEl.set("text",i)),this.get("hasDialogArrow")&&!r.hasClass(t.css.hasDialogArrow)&&r.addClass(t.css.hasDialogArrow),r.hasClass(t.css.hasDialogArrow)&&(this.dialogArrowEl=r.one(t.css.dialogArrow),this.dialogArrowEl||(this.dialogArrowEl=e.Node.create('<span class="ui-dialog-arrow" />'),r.insert(this.dialogArrowEl,1))),this.get("useCheckMarks")&&!r.hasClass(t.css.useCheckMarks)&&r.addClass(t.css.useCheckMarks),this.select();if(this.get("disabled"))return this.disable();this.attachEvents({":toggle":this.toggle.bind(this),":set":function(t,r){t.halt();if(!n.get("multiSelect")&&!n.get("multiSelectSub")&&e.Array.indexOf(n.get("selected"),r.value)>=0)return n.close();n.select(r.value,r)}})},select:function(n,r,i){var s=this,o=n?this._items[n]:null,u=!0,a=[],f;o&&e.Array.indexOf(this.get("selected"),n)>=0&&(this.get("multiSelect")||this.get("multiSelectSub"))?(a=this.get("selected"),!o.sub&&this.get("multiSelect")&&a.length>this.get("minimumSelected")?(a.splice(e.Array.indexOf(this.get("selected"),n),1),u=!1):o.sub&&(a.splice(e.Array.indexOf(this.get("selected"),n),1),u=!1),this.set("selected",a)):o&&(o.sub?(a.push(n),this.get("selectParent")&&a.push(o.sub),e.Array.each(this.get("selected"),function(e){s._items[e].sub===o.sub?a.push(e):s.get("multiSelect")&&!s._items[e].sub&&a.push(e)})):this.get("multiSelect")?(a=this.get("selected"),a.push(n)):a.push(n),this.set("selected",a)),i||this.close(),f={clicked:o?{text:o.text,value:n,sub:o.sub,itemEl:o.node,isChecked:u}:null,data:r,selections:a},this.fire("selected",f),this.update(n,f,t)},update:function(t,n,r){var i=this,s=n.clicked,o=this.get("selected"),u=this.get("defaultLabel")||"[Unable to select a default item]";this.get("staticLabel")||(this.get("labelFunction")?u=this.get("labelFunction").apply(this,[t]):s?n.data&&n.data.text&&n.data.text!==s.text?u=n.data.text:u=s.text:o.length>0&&i._items[o[0]]&&(u=i._items[o[0]].text),this.labelEl.set("textContent",u||"[!empty data-text!]")),this.get("container").all(r.css.items).removeClass(r.css.itemSelected),e.Array.each(o,function(e){i._items[e]&&i._items[e].node.addClass(r.css.itemSelected)})},toggle:function(e){e&&e.halt(),this._open?this.close(e):this.open(e)},open:function(e){var n=this.get("container"),r=0,i=0,s=30;this._open=!0,this.get("shouldCreateShim")&&this._shimUp(),n.removeClass(t.css.closed),this.get("autoSizeMenu")&&(r=parseInt(this.labelEl.getComputedStyle("width"),10),i=parseInt(n.one("ul").getComputedStyle("width"),10),r+s>i&&n.one("ul").setStyles({width:r+s})),(!e||!e.silent)&&this.fire("open",e)},close:function(e){e&&e.halt(),this._open=!1,this._shimUp(!1),this.fire("close",e),this.get("container").addClass(t.css.closed)},_shimUp:function(n){if(n===!1){if(!this._shim)return;this._shim.detach("click").remove(),this._shim=null;return}this._shim=e.Node.create("<div />"),this._shim.addClass(t.css.shim),this._shim.on("click",this.close.bind(this)),this.get("container").appendChild(this._shim)},disable:function(){var e=this.get("container");this.set("disabled",!0),this.close(),e.addClass(t.css.disabled),e.detach()},destructor:function(){this._shimUp(!1),this._items=null,this.labelEl=null,this.set("selected",null),this.detachAll()}},{ATTRS:{selected:{value:[]},disabled:{value:!1},hasDialogArrow:{value:!1},useCheckMarks:{value:!1},multiSelect:{value:!1},multiSelectSub:{value:!1},selectParent:{value:!0},minimumSelected:{value:0},staticLabel:{value:!1},defaultLabel:{value:!1},labelFunction:function(){},shouldCreateShim:{value:!0},autoSizeMenu:{value:!0}}})},"@VERSION@",{requires:["flickr-view","flickrui-css"]});
YUI.add("hermes-template-fluid-droparound",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function c(e,t){return" html"}function h(e,t){return" subview-droparound"}function p(e,t){return" menu"}function d(e,t){var r="",i;return r+="max-height: ",(i=n.staticHeight)?i=i.call(e,{hash:{},data:t}):(i=e.staticHeight,i=typeof i===u?i.apply(e):i),r+=a(i)+"px; min-height: ",(i=n.staticHeight)?i=i.call(e,{hash:{},data:t}):(i=e.staticHeight,i=typeof i===u?i.apply(e):i),r+=a(i)+"px; ",r}function v(e,t){var r="",i;return r+="width: ",(i=n.staticWidth)?i=i.call(e,{hash:{},data:t}):(i=e.staticWidth,i=typeof i===u?i.apply(e):i),r+=a(i)+"px;",r}function m(e,t){return"position: fixed;"}function g(e,t){return"hide-head"}function y(e,t){var r="",i;return r+='\n			<div class="content text-only">\n				',(i=n.textMessage)?i=i.call(e,{hash:{},data:t}):(i=e.textMessage,i=typeof i===u?i.apply(e):i),r+=a(i)+"\n			</div>\n		",r}function b(e,t){var r="",i,s;return r+='\n			<div class="content html-only">\n				',s={hash:{},data:t},r+=a((i=n.renderTrustedMarkup||e.renderTrustedMarkup,i?i.call(e,e.htmlMessage,s):f.call(e,"renderTrustedMarkup",e.htmlMessage,s)))+"\n			</div>\n		",r}function w(e,t){return'\n			<div class="content subview"></div>\n		'}function E(e,t){var r="",i;r+='\n			<div class="content menu">\n				<ul role="menu">\n					',i=n.each.call(e,e.menuItems,{hash:{},inverse:l.noop,fn:l.program(22,S,t),data:t});if(i||i===0)r+=i;return r+="\n				</ul>\n			</div>\n		",r}function S(e,t){var r="",i;r+='\n					<li role="menuitem">',i=n["if"].call(e,e.href,{hash:{},inverse:l.noop,fn:l.program(23,x,t),data:t});if(i||i===0)r+=i;(i=n.text)?i=i.call(e,{hash:{},data:t}):(i=e.text,i=typeof i===u?i.apply(e):i),r+=a(i),i=n["if"].call(e,e.href,{hash:{},inverse:l.noop,fn:l.program(26,N,t),data:t});if(i||i===0)r+=i;return r+="</li>\n					",r}function x(e,t){var r="",i;r+='<a href="',(i=n.href)?i=i.call(e,{hash:{},data:t}):(i=e.href,i=typeof i===u?i.apply(e):i),r+=a(i)+'"',i=n["if"].call(e,e.className,{hash:{},inverse:l.noop,fn:l.program(24,T,t),data:t});if(i||i===0)r+=i;return r+=">",r}function T(e,t){var r="",i;return r+=' class="',(i=n.className)?i=i.call(e,{hash:{},data:t}):(i=e.className,i=typeof i===u?i.apply(e):i),r+=a(i)+'"',r}function N(e,t){return"</a>"}function C(e,t){return"hide-foot"}function k(e,t){return'\n		<div class="droparrow up"></div>\n	'}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=n.helperMissing,l=this;s+='<div class="droparound',o=n["if"].call(t,t.htmlMessage,{hash:{},inverse:l.noop,fn:l.program(1,c,i),data:i});if(o||o===0)s+=o;o=n["if"].call(t,t.subview,{hash:{},inverse:l.noop,fn:l.program(3,h,i),data:i});if(o||o===0)s+=o;o=n["if"].call(t,t.menuItems,{hash:{},inverse:l.noop,fn:l.program(5,p,i),data:i});if(o||o===0)s+=o;s+=" ",(o=n.classList)?o=o.call(t,{hash:{},data:i}):(o=t.classList,o=typeof o===u?o.apply(t):o),s+=a(o)+'"\nstyle="',o=n["if"].call(t,t.staticHeight,{hash:{},inverse:l.noop,fn:l.program(7,d,i),data:i});if(o||o===0)s+=o;s+="\n",o=n["if"].call(t,t.staticWidth,{hash:{},inverse:l.noop,fn:l.program(9,v,i),data:i});if(o||o===0)s+=o;s+="\n",o=n["if"].call(t,t.positionFixed,{hash:{},inverse:l.noop,fn:l.program(11,m,i),data:i});if(o||o===0)s+=o;s+='">\n	<div class="head ',o=n.unless.call(t,t.headContent,{hash:{},inverse:l.noop,fn:l.program(13,g,i),data:i});if(o||o===0)s+=o;s+='">\n		',(o=n.headContent)?o=o.call(t,{hash:{},data:i}):(o=t.headContent,o=typeof o===u?o.apply(t):o),s+=a(o)+'\n	</div>\n	<div class="body">\n		',o=n["if"].call(t,t.textMessage,{hash:{},inverse:l.noop,fn:l.program(15,y,i),data:i});if(o||o===0)s+=o;s+="\n		",o=n["if"].call(t,t.htmlMessage,{hash:{},inverse:l.noop,fn:l.program(17,b,i),data:i});if(o||o===0)s+=o;s+="\n		",o=n["if"].call(t,t.subview,{hash:{},inverse:l.noop,fn:l.program(19,w,i),data:i});if(o||o===0)s+=o;s+="\n		",o=n["if"].call(t,t.menuItems,{hash:{},inverse:l.noop,fn:l.program(21,E,i),data:i});if(o||o===0)s+=o;s+='\n	</div>\n	<div class="foot ',o=n.unless.call(t,t.footContent,{hash:{},inverse:l.noop,fn:l.program(28,C,i),data:i});if(o||o===0)s+=o;s+='">\n		',(o=n.footContent)?o=o.call(t,{hash:{},data:i}):(o=t.footContent,o=typeof o===u?o.apply(t):o),s+=a(o)+"\n	</div>\n	",o=n["if"].call(t,t.showDropArrow,{hash:{},inverse:l.noop,fn:l.program(30,k,i),data:i});if(o||o===0)s+=o;return s+="\n</div>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/fluid-droparound",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-flickr-balls",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{},'<div class="balls">\n	<div class="blue ball"></div><div class="pink ball"></div>\n</div>'}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/flickr-balls",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("fluid-overlay-manager-view",function(e){"use strict";var t=e.Base.create("overlayManager",e.Base,[],{add:function(t){var n=this.get("overlay"),r=t.getAttrs(),i=this;this.get("modals").push(t),n?r.dismissOnOverlayClick&&this.set("dismissOnOverlayClick",!0):(n=e.Node.create(this.get("overlayHTML")),e.one("body").append(n),this.set("overlay",n),this.addOverlayClickHandler(n),r.dismissOnOverlayClick?this.set("dismissOnOverlayClick",!0):this.set("dismissOnOverlayClick",!1)),this.setOverlayStyle(r),r.dismissOnActionClick&&t.on("actionClick",function(){setTimeout(function(){i.close()},0)}),t.name==="fluid-modal-view"&&t.on("cancelClick",function(){i.close()})},setOverlayStyle:function(e){var t="",n="",r="",i=this.get("overlay");e.hideModalOverlay&&(t="transparent"),e.darkOverlay&&(t="dark-overlay"),e.invisibleOverlay&&(n="invisible"),e.overlayClassList&&(r=e.overlayClassList),i.setAttribute("class",this.get("overlayClass")+" "+r+" "+t+" "+n)},addOverlayClickHandler:function(e){e.getDOMNode().addEventListener("click",this.clickHandler.bind(this))},removeOverlayClickHandler:function(e){e.getDOMNode().removeEventListener("click",this.clickHandler.bind(this))},clickHandler:function(){var e=this.get("modals").length-2,t="",n="",r="",i,s=this.get("overlay");this.get("dismissOnOverlayClick")&&(this.set("dismissOnOverlayClick",!1),this.close(),e>-1&&this.get("modals").length>0&&(i=this.get("modals")[e].getAttrs(),i.hideModalOverlay&&(t="transparent"),i.invisibleOverlay&&(n="invisible"),i.overlayClassList&&(r=i.overlayClassList),s.setAttribute("class",this.get("overlayClass")+" "+r+" "+t+" "+n),this.set("dismissOnOverlayClick",i.dismissOnOverlayClick)))},remove:function(e){var t=this.get("modals");if(e.isClosed){var n=t.indexOf(e);n>-1?t.splice(n,1):t.length===1&&(n=0,t.splice(n,1)),this.removeOverlay()}},close:function(){var e=this.get("modals").pop();e&&!e.isClosed&&e.close(),this.removeOverlay()},closeAll:function(){var e=this;this.get("modals").forEach(function(t,n){e.close()})},removeOverlay:function(){var e=this.get("overlay");if(this.get("modals").length===0&&e)this.removeOverlayClickHandler(e),e.remove(),this.set("overlay",undefined);else{var t=this.get("modals").length-1;t>-1&&this.setOverlayStyle(this.get("modals")[t].getAttrs())}},alreadyShowingModal:function(e){var t=!1;return e||(e="fluid-modal-view"),this.get("modals").forEach(function(n,r){n.name===e&&(t=!0)}),t}},{ATTRS:{modals:{value:[],validator:function(t){return e.Lang.isArray(t)}},overlayHTML:{},overlayClass:{},overlay:{value:undefined},dismissOnOverlayClick:{value:!0,setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},validator:function(t){return e.Lang.isBoolean(t)}}}});e.OverlayManager={DroparoundOverlay:new t({overlayHTML:'<div class="fluid-droparound-overlay"></div>',overlayClass:"fluid-droparound-overlay"}),ModalOverlay:new t({overlayHTML:'<div class="fluid-modal-overlay"><div class="balls"></div></div>',overlayClass:"fluid-modal-overlay"})}},"@VERSION@",{requires:["base","flickr-view","attribute-helpers","fluid-css","fluid-balls-css"],optional:[],langBundles:[],optionalRequires:["fluid"]});
YUI.add("fluid",function(e){"use strict";function n(){var n="",r=[];return!t.prefix&&"getComputedStyle"in e.config.win&&(r=Array.prototype.slice.call(e.config.win.getComputedStyle(e.config.doc.documentElement,"")),n=r.join("").match(/-(webkit|moz|ms)-/),n=n&&n.length>1?n[1]:"",t.prefix.raw=n.toLowerCase(),t.prefix.css="-"+n+"-",t.prefix.js=n.charAt(0).toUpperCase()+n.slice(1),t.prefix.dom="WebKit|Moz|MS".match(new RegExp("("+n+")","i"))[1]),t.prefix}function r(t,n){return n=n||e.config.win,new e.Promise(function(r,i){setTimeout(e.bind(function(){r(t.call(n))},n),1)})}function i(e,n,r){return t.prefix.css!==""?r.getDOMNode().style.setProperty(t.prefix.css+e,n,null):r.setStyle(e,n),r}function s(n){var r=!1;return n+="",r=n in e.config.doc.body.style,r||(n=n.charAt(0).toUpperCase()+n.slice(1),r=t.prefix.raw+n in e.config.doc.body.style),r}function o(n,r){return r=r||{timeout:1e4,retry:!1},r.timeout=parseInt(r.timeout,10),isNaN(r.timeout)&&(r.timeout=1e4),new e.Promise(function(e,i){t.loadImage.imageQueue.push({src:n,options:r,done:e,error:i}),u()})}function u(){var e=null;t.loadImage.currentWorkers<t.loadImage.maxWorkers-1&&t.loadImage.imageQueue.length&&(t.loadImage.currentWorkers++,e={image:new Image,work:t.loadImage.imageQueue.shift(),timeout:null,loaded:null,finished:null},e.finished=function(e){return function(n){clearTimeout(e.timeout),e.image.removeEventListener("load",e.finished),e.image.removeEventListener("error",e.finished),e.image.removeEventListener("abort",e.finished),n.type==="load"?e.work.done(e.work.src):e.work.options.retry?o(e.work.src,{retry:!1,timeout:e.work.options.timeout}).then(function(e){return function(t){e(t)}}(e.work.done),function(e){return function(t){e(t)}}(e.work.done)):e.work.error(e.work.src),e.image=null,e=null,t.loadImage.currentWorkers--,u()}}(e),e.image.addEventListener("load",e.finished),e.image.addEventListener("error",e.finished),e.image.addEventListener("abort",e.finished),e.image.src=e.work.src,e.timeout=setTimeout(function(e){return function(){e.finished({type:"error"})}}(e),e.work.options.timeout),e.image.complete&&e.finished({type:"load"}))}function a(n){return n="https:"+n,new e.Promise(function(e,r){t.loadImageFastLane.imageHash[n]={done:e,error:r},t.loadImageFastLane.imageQueue.push(n),f()})}function f(){var e,n;t.loadImageFastLane.currentWorkers<t.loadImageFastLane.maxWorkers&&t.loadImageFastLane.imageQueue.length&&(e=t.loadImageFastLane.imageQueue.shift(),n=l(),n.onmessage=function(e){var n=e.data;t.loadImageFastLane.imageHash[n].done(n),t.loadImageFastLane.currentWorkers--,f()}.bind(this),n.postMessage(e),t.loadImageFastLane.currentWorkers++)}function l(){var e=window.URL||window.webkitURL,t;return t=e.createObjectURL(new Blob(["(",function(){self.onmessage=function(e){var t=new XMLHttpRequest,n=e.data;t.responseType="blob",t.onerror=function(){self.postMessage(n),self.close()},t.onload=function(){self.postMessage(n),self.close()},t.open("GET",n,!0),t.withCredentials=!0,t.send()}}.toString(),")()"],{type:"application/javascript"})),new Worker(t)}function c(t){var n;return t&&(n=e.config.doc.createElement("div"),n.appendChild(e.config.doc.createTextNode(t)),t=n.innerHTML),t}var t={prefix:{raw:"",css:"",js:"",dom:""},loadImage:{maxWorkers:8,currentWorkers:0,imageQueue:[],workingWorkers:[]},loadImageFastLane:{maxWorkers:8,currentWorkers:0,imageHash:{},imageQueue:[],availabeWorkers:[],workingWorkers:[]}};(function(){n()})(),e.fluid={determineBrowserPrefix:n,setStylePrefixed:i,supports:s,prefix:t.prefix,chill:r,loadImage:o,loadImageFastLane:a,escapeHtml:c}},"@VERSION@",{requires:["flickr-promise"],optional:[],affinity:"client"});
YUI.add("fluid-droparound-view",function(e){"use strict";var t,n;t={css:{destinationContainer:"body",subviewContent:".content.subview",menuContent:".content.menu",droparoundContainer:".droparound",droparoundContent:".body .content",droparrow:".droparrow"},options:{}},n={supportsTransform:!1,droparound:{height:0,width:0}},e.namespace("Views").FluidDroparound=e.FlickrView.create(this.name,e.FlickrView,[],{initializer:function(e){this.set("isActiveViewAgnostic",!0)},buildContainer:function(){return!this.get("textMessage")&&!this.get("htmlMessage")&&!this.get("subview")&&!this.get("menuItems")?(this.appContext.warn("FluidDroparoundView requires a `textMessage`, `htmlMessage`, `subview`, or `menuItems`."),this):(this.get("menuItems")&&this.set("menuItems",this.get("menuItems").filter(function(e){return!e.hidden})),this.setContainerHTML(this.templates("fluid-droparound")({textMessage:this.get("textMessage"),htmlMessage:this.get("message")?this.get("message"):this.get("htmlMessage"),subview:!!this.get("subview"),menuItems:this.get("menuItems"),showDropArrow:this.get("showDropArrow"),hideModalOverlay:this.get("hideModalOverlay"),hideDroparoundOverlay:this.get("hideDroparoundOverlay"),classList:this.get("classList"),footContent:this.get("footContent"),headContent:this.get("headContent"),staticWidth:this.get("width"),staticHeight:this.get("height"),positionFixed:this.get("positionFixed")})),this.appendAndPosition(),this)},activate:function(){var n=this.get("container"),r=this;return e.OverlayManager.DroparoundOverlay.add(this),this.registerEventHandler(e.on("droparound:reposition",e.bind(this.anchorPositionChange,this))),this.registerEventHandler(e.on("history:change",function(e){if(e.src==="popstate"&&e.prevVal&&e.newVal)if(!e.prevVal.flickr||!e.prevVal.flickr.referrer||e.newVal.flickr&&e.newVal.flickr.referrer)return;r.close(e)})),this.get("subview")&&this.loadSubview(),this.get("menuItems")&&this.registerEventHandler(n.one(t.css.menuContent).delegate("click",this.onMenuItemClick.bind(this),"li")),this.get("observePageResize")&&this.observePageResize(),this.get("closeOnScroll")&&this.observePageScroll(),this.fire("activated"),this},loadSubview:function(){var n,r,i=!1,s=this.get("subview"),o=this;n=this.get("container").one(t.css.subviewContent),n.appendChild(e.Node.create(this.templates("flickr-balls")({})).addClass("flickr-balls")),r=setTimeout(function(){i=!0},40),this.loading=!0,s.appContext=o.appContext,s.set("isActiveViewAgnostic",!0),s.initialize().then(function(e){clearTimeout(r),i&&(e.get("container").addClass("load-transition"),setTimeout(function(){e.get("container").removeClass("load-transition")},1)),o.onSubviewInitialized(e)})},onSubviewInitialized:function(n){var r=this,i=this.get("container").one(t.css.subviewContent);if(!this.loading)return;this.loading=!1,i.one(".flickr-balls").remove(!0),i.appendChild(n.get("container")),n.on("subviewViewEvent",function(e){e&&e.details&&e.details.length&&r.fire.apply(r,e.details)}),n.normalizedActivate(),n.recursivelyActivateSubviews(),r.appendAndPosition(),r.registerEventHandler(r.get("subview").on("actionClick",e.bind(r.handleAction,r)))},onMenuItemClick:function(e){var n,r;n=e.target.ancestor("li",!0),n&&(r=this.get("container").one(t.css.menuContent).all("li").indexOf(n),r!==-1&&this.fire("selected",{menuItemIndex:r,menuItem:this.get("menuItems")[r]}))},appendAndPosition:function(){var r=e.one(t.css.destinationContainer),i=this.get("container").one(t.css.droparoundContainer);r&&(r.append(this.get("container")),n.droparound.width=this.get("width")||i.getComputedStyle("width"),n.droparound.height=this.get("height")||i.getComputedStyle("height"),this.repositionToElement(this.get("anchorElement")))},anchorPositionChange:function(){this.repositionToElement(this.get("anchorElement"))},observePageResize:function(){this.registerEventHandler(e.globalEvents.subscribe("window:resize",function(t){e.fire("droparound:reposition")}))},observePageScroll:function(){var t=YUI.Env.isServer?0:e.config.win.pageYOffset,n=this;this.get("startingScrollPoint")||this.set("startingScrollPoint",t),this.registerEventHandler(e.globalEvents.subscribe("window:scroll",n.handleScroll.bind(n)))},handleScroll:function(t){var n,r=this.get("startingScrollPoint");r?(n=e.config.win.pageYOffset,r+this.get("closeOnScrollDistance")<n&&this.handleClose(t)):this.set("startingScrollPoint",e.config.win.pageYOffset)},repositionToElement:function(r){var i=this.get("container"),s=e.one("body"),o=i.one(".droparound"),u=o.one(t.css.droparrow),a=r.getXY(),f=this.get("mirrorArrowAdjustment"),l=s.get("offsetWidth"),c=this.get("showDropArrow"),h=this.get("anchorOffsetVertical"),p=this.get("anchorOffsetHorizontal"),d=this.get("anchorPositionOffset"),v=this.get("minVerticalSpace"),m=o.get("offsetHeight"),g=o.get("offsetWidth"),y=parseInt(r.getComputedStyle("width"),10)||r.get("offsetWidth"),b=parseInt(r.getComputedStyle("height"),10)||r.get("offsetHeight"),w=this.get("dropdownArrowWidth"),E=n.droparound.width?parseInt(n.droparound.width,10):parseInt(o.getComputedStyle("width"),10),S=n.droparound.height?parseInt(n.droparound.height,10):parseInt(o.getComputedStyle("height"),10),x=o.one(t.css.droparoundContent),T=this.get("minHorizontalSpace")+Math.max(m,S),N=l-Math.max(g,E)-d-T,C=r.getDOMNode().getBoundingClientRect(),k=Math.ceil((y-w)/2),L,A,O,M,_,D,P,H=this.get("preferLeft"),B=this.get("preferTop");O=E||g,M=S||m,A=a[0]-p,L=a[1]-S-h,this.get("preferredSide")?this.get("preferredSide")==="left"&&(L=a[1]+Math.round(y/2)-h,A=a[0]+y,o.one(".droparrow").removeClass("down").addClass("left")):(D=L<v||C.top-S-h<v,P=A>N,!B&&D||B&&!D?(L=a[1]+b+h,c&&u.removeClass("up").addClass("down").setStyle("left",k+f+p+"px")):c&&u.removeClass("down").addClass("up").setStyle("left",k+f+p+"px"),!H&&P||H&&!P?a[0]+y+p>l?(A=a[0]-E,c&&u.addClass("right").setStyle("left","auto").setStyle("right",k+y+"px")):(A=a[0]-E+y+p,c&&u.addClass("right").setStyle("left","auto").setStyle("right",k+p+"px")):c&&u.removeClass("right").setStyle("right"
,"auto").setStyle("left",k+f+p+"px")),o.setXY([A,L]),this.get("menuItems")||(_={width:O+"px",height:M+"px"},x.setStyles(_))},handleClose:function(e){this.fire("closeDroparound",e),this.close()},handleAction:function(e){this.fire("actionClick",e),this.get("dismissOnActionClick")&&this.close(e)},show:function(){var e=!this.isActivated,t=this;return this.initialize().then(function(){t.isClosed=!1,e||t.activate()}),this},close:function(){var t=this.get("container");this.loading=!1,this.isClosed=!0,this.destroy(),this.get("subview")&&this.get("subview").destroy(),t&&t.remove(!0),e.OverlayManager.DroparoundOverlay.remove(this)},destructor:function(){this.detachAll()}},{ATTRS:{dismissOnOverlayClick:{value:!0,validator:function(t,n){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,n){return e.AttributeHelpers.coerceBoolean(t)}},dismissOnActionClick:{value:!0,validator:function(t,n){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,n){return e.AttributeHelpers.coerceBoolean(t)}},hideModalOverlay:{value:!0,validator:function(t,n){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,n){return e.AttributeHelpers.coerceBoolean(t)}},invisibleOverlay:{value:!1,validator:function(t,n){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,n){return e.AttributeHelpers.coerceBoolean(t)}},preferredSide:{value:null},message:{value:null},textMessage:{value:null},htmlMessage:{value:null},footContent:{value:null},headContent:{value:null},width:{value:0,validator:function(t,n){return e.AttributeHelpers.validateInteger(t)},setter:function(t,n){return e.AttributeHelpers.coerceInteger(t)}},height:{value:0,validator:function(t,n){return e.AttributeHelpers.validateInteger(t)},setter:function(t,n){return e.AttributeHelpers.coerceInteger(t)}},subview:{value:null},menuItems:{value:null},classList:{value:"",validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t,n){return e.AttributeHelpers.coerceString(t)}},anchorElement:{value:null},showDropArrow:{value:!1,validator:function(t,n){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,n){return e.AttributeHelpers.coerceBoolean(t)}},anchorOffsetVertical:{value:15,validator:function(t,n){return e.AttributeHelpers.validateInteger(t)},setter:function(t,n){return e.AttributeHelpers.coerceInteger(t)}},anchorOffsetHorizontal:{value:5,validator:function(t,n){return e.AttributeHelpers.validateInteger(t)},setter:function(t,n){return e.AttributeHelpers.coerceInteger(t)}},contentPadding:{value:12,validator:function(t,n){return e.AttributeHelpers.validateInteger(t)},setter:function(t,n){return e.AttributeHelpers.coerceInteger(t)}},minVerticalSpace:{value:60,validator:function(t,n){return e.AttributeHelpers.validateInteger(t)},setter:function(t,n){return e.AttributeHelpers.coerceInteger(t)}},minHorizontalSpace:{value:60,validator:function(t,n){return e.AttributeHelpers.validateInteger(t)},setter:function(t,n){return e.AttributeHelpers.coerceInteger(t)}},dropdownArrowWidth:{value:21,validator:function(t,n){return e.AttributeHelpers.validateInteger(t)},setter:function(t,n){return e.AttributeHelpers.coerceInteger(t)}},anchorPositionOffset:{value:15,validator:function(t,n){return e.AttributeHelpers.validateInteger(t)},setter:function(t,n){return e.AttributeHelpers.coerceInteger(t)}},observePageResize:{value:!0,validator:function(t,n){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,n){return e.AttributeHelpers.coerceBoolean(t)}},preferLeft:{value:!1,validator:function(t,n){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,n){return e.AttributeHelpers.coerceBoolean(t)}},preferTop:{value:!1,validator:function(t,n){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,n){return e.AttributeHelpers.coerceBoolean(t)}},mirrorArrowAdjustment:{value:0,validator:function(t,n){return e.AttributeHelpers.validateInteger(t)},setter:function(t,n){return e.AttributeHelpers.coerceInteger(t)}},positionFixed:{value:!1,validator:function(t,n){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,n){return e.AttributeHelpers.coerceBoolean(t)}},closeOnScroll:{value:!1,validator:function(t,n){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,n){return e.AttributeHelpers.coerceBoolean(t)}},closeOnScrollDistance:{value:40,validator:function(t,n){return e.AttributeHelpers.validateInteger(t)},setter:function(t,n){return e.AttributeHelpers.coerceInteger(t)}},overlayClassList:{value:"",validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t,n){return e.AttributeHelpers.coerceString(t)}}}})},"@VERSION@",{requires:["flickr-view","fluid-css","hermes-template-fluid-droparound","fluid-balls-css","hermes-template-flickr-balls","fluid-overlay-manager-view","attribute-helpers"],optionalRequires:["fluid"]});
YUI.add("footer-full-view",function(e){var t=["en-US","zh-HK","de-DE","es-US","fr-FR","ko-KR","it-IT","pt-BR","vn-VN","id-ID"],n={"en-US":"English","de-DE":"Deutsch","es-US":"Espa\u00f1ol","fr-FR":"Fran\u00e7ais","ko-KR":"\ud55c\uae00","it-IT":"Italiano","pt-BR":"Portugu\u00eas","vn-VN":"Ti\u1ebfng Vi\u1ec7t","id-ID":"Bahasa Indonesia","zh-HK":"\u7e41\u9ad4\u4e2d\u6587"};e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.get("container").get("innerHTML")===""&&this.setContainerHTML('<div class="footer-full-content"></div>'),this.appStateParams=e,this.set("hideOptOutBanner",e.hideOptOutBanner),this.set("showOptOutBanner",e.showOptOutBanner),this},subviewConfig:{},loadState:function(){var r,i,s;s=this.appContext.auth&&this.appContext.auth.csrf?this.appContext.auth.csrf:"",this.lang=this.appContext.lang,this.menuLangs=[],this.lang==="zh-Hant-HK"&&(this.lang="zh-HK"),this.lang.toLowerCase()==="vi-vn"&&(this.lang="vn-VN"),this.selectedLang={code:this.lang,name:n[this.lang],csrf:s};for(r=0,i=t.length;r<i;r++){if(t[r]===this.lang)continue;typeof t[r]=="string"&&this.menuLangs.push({code:t[r].toLowerCase(),name:n[t[r]],csrf:s})}return e.Promise.resolve()},buildContainer:function(){var t={},n={},r=this.appContext.flipper.toJSON(),i=[];return this.get("viewer")&&(t=e.merge(this.get("viewer").toJSON(),{urls:e.URLHelper.generatePersonUrls(this.get("viewer"))})),this.get("showOptOutBanner")===!0&&(r["rebootify-group-members"]===!0&&i.push({name:"groups_members_opt",value:0}),r["enable-groups-discussion-optout"]===!0&&i.push({name:"groups_discuss_opt",value:0}),r["enable-groups-optout"]===!0&&i.push({name:"groups_opt",value:0}),n.optOutFlippers=i),n={hideOptOutBanner:this.get("hideOptOutBanner"),showOptOutBanner:this.get("showOptOutBanner"),csrf:this.appContext.auth.csrf?this.appContext.auth.csrf:"",flippers:r,optOutFlippers:i,displayLangs:this.displayLangs,selectedLang:this.selectedLang,menuLangs:this.menuLangs},YUI.Env.isServer?n.pageUrl=this.appContext.request.url:n.pageUrl=window.location.pathname,this.setContainerHTML(this.templates("footer-full")(n)),this},activate:function(){var t=this.get("container"),n=t.one(".lang-switcher"),r=n.one("a");return this.menuLangsFormatted=this.menuLangs.map(function(e){return{href:"/change_language.gne?lang="+e.code+"&csrf="+e.csrf,text:e.name}}),this.registerEventHandler(n.on("click",function(t){t.preventDefault(),r.addClass("dimmed");var i=new e.Views.FluidDroparound({anchorOffsetHorizontal:n.get("offsetWidth"),appContext:this.appContext,showDropArrow:!0,observePageResize:!0,dismissOnOverlayClick:!0,anchorElement:n.one(".arrow"),classList:["lang-droparound"],menuItems:this.menuLangsFormatted});i.show(),this.registerEventHandler(i.on("closeDroparound",function(e){r.removeClass("dimmed")}),this)},this)),this}})},"@VERSION@",{requires:["flickr-view","hermes-template-footer-full","footer-full-css","url-helper","flickrui-css","flickrui-dialogs-css","dropdown","fluid-droparound-view"],langBundles:["common"]});
YUI.add("togglebutton",function(e){"use strict";var t,n;t={css:{toggledOn:"ui-togglebutton-on",label:'span[data-action="toggle"]',disabled:"ui-togglebutton-disabled",icon:"ui-togglebutton-icon"},options:{}},e.namespace("Views").ToggleButton=n=e.Base.create("ToggleButton",e.FlickrView,[],{initializer:function(e){if(e.activate===!1)return;this.activate()},activate:function(){var n=this.get("container");n.getData("label")&&this.set("label",n.getData("label")),n.getData("labelToggled")&&this.set("labelToggled",n.getData("labelToggled")),this.labelEl=n.one(t.css.label),this.labelEl||(this.labelEl=e.Node.create('<span class="truncate" data-action="toggle" />'),n.insert(this.labelEl,0)),this.update(this.get("toggled")),this.get("showIcon")&&n.addClass(t.css.icon);if(this.get("disabled"))return this.disable();this.attachEvents({":toggle":this.toggle.bind(this)})},update:function(e){var n=this.get("container");e?(n.addClass(t.css.toggledOn),this.get("labelToggled")&&n.one(t.css.label).set("textContent",this.get("labelToggled"))):(n.removeClass(t.css.toggledOn),n.one(t.css.label).set("textContent",this.get("label")))},toggle:function(e){e,this.set("toggled",!this.get("toggled")),this.update(this.get("toggled")),this.fire("toggle",e,this.get("toggled")?"on":"off")},disable:function(){var e=this.get("container");this.set("disabled",!0),e.addClass(t.css.disabled),e.detach()},destructor:function(){this.labelEl=null,this.detachAll()}},{ATTRS:{disabled:{value:!1},toggled:{value:!1},label:{value:"Toggle Me"},labelToggled:{value:"Toggled!"},showIcon:{value:!1}}})},"@VERSION@",{requires:["flickr-view","flickrui-css"]});
YUI.add("hermes-template-filter-bar-neutered",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function p(e,t){var r="",i,s;return r+='\n<div class="fluid opt-out-bug">\n	<form id="optin" action="/help/optin" method="post">\n		<input type="hidden" name="unifiedgroupssearchpage_opt" value="1">\n		<input type="hidden" name="unifiedpeoplesearchpage_opt" value="1">\n		<input type="hidden" name="advsearchpage_opt" value="1">\n		<input type="hidden" name="redirect_url" value="',(i=n.pageUrl)?i=i.call(e,{hash:{},data:t}):(i=e.pageUrl,i=typeof i===f?i.apply(e):i),r+=l(i)+'"></input>\n		<input type="hidden" name="csrf" value="',(i=n.csrf)?i=i.call(e,{hash:{},data:t}):(i=e.csrf,i=typeof i===f?i.apply(e):i),r+=l(i)+'"></input>\n		<button>',s={hash:{intlName:"search.OPT_IN_MESSAGE"},data:t},r+=l((i=n.intlHTMLMessage||e.intlHTMLMessage,i?i.call(e,s):c.call(e,"intlHTMLMessage",s)))+"</button>\n	</form>\n</div>\n",r}function d(e,t){var r="",i,s;return r+='\n						<li role="menuitem" data-track="searchFilterScopeYourPhotosClick" data-action="set" data-value="1" data-text="',s={hash:{intlName:"filter-bar.YOUR_PHOTOS"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):c.call(e,"intlMessage",s)))+' &nbsp;\u25be">',s={hash:{intlName:"filter-bar.YOUR_PHOTOS"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):c.call(e,"intlMessage",s)))+'</li>\n						<li role="menuitem" data-track="searchFilterScopeYourContactsPhotosClick" data-action="set" data-value="2" data-text="',s={hash:{intlName:"filter-bar.CONTACTS_PHOTOS"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):c.call(e,"intlMessage",s)))+' &nbsp;\u25be">',s={hash:{intlName:"filter-bar.CONTACTS_PHOTOS"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):c.call(e,"intlMessage",s)))+"</li>\n					",r}function v(e,t){var r="",i,s;return r+='\n						<li role="menuitem" data-track="searchFilterScopeContactPhotosClick" data-action="set" data-value="3" data-text="',s={hash:{intlName:"filter-bar.USER_PHOTOS",name:(i=e.personModel,i==null||i===!1?i:i.displayname)},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):c.call(e,"intlMessage",s)))+' &nbsp;\u25be" data-nsid="'+l((i=(i=e.personModel,i==null||i===!1?i:i.nsid),typeof i===f?i.apply(e):i))+'">',s={hash:{intlName:"filter-bar.USER_PHOTOS",name:(i=e.personModel,i==null||i===!1?i:i.displayname)},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):c.call(e,"intlMessage",s)))+"</li>\n					",r}function m(e,t){var r="",i,s;return r+='\n						<li role="menuitem" data-track="searchFilterScopeGroupPhotosClick" data-action="set" data-value="4" data-text="',s={hash:{intlName:"filter-bar.GROUP_PHOTOS",name:(i=e.groupModel,i==null||i===!1?i:i.title)},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):c.call(e,"intlMessage",s)))+' &nbsp;\u25be" data-nsid="'+l((i=(i=e.groupModel,i==null||i===!1?i:i.id),typeof i===f?i.apply(e):i))+'">',s={hash:{intlName:"filter-bar.GROUP_PHOTOS",name:(i=e.groupModel,i==null||i===!1?i:i.title)},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):c.call(e,"intlMessage",s)))+"</li>\n					",r}function g(e,t){var r="",i,s;return r+='\n		<li role="menuitem">\n			<div class="filter-cc-label ui-togglebutton ui-togglebutton-icon ui-unselectable-text" data-label="',s={hash:{intlName:"filter-bar.LICENSE"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):c.call(e,"intlMessage",s)))+':" data-labeltoggled="',s={hash:{intlName:"filter-bar.LICENSE"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):c.call(e,"intlMessage",s)))+':">\n				<span class="truncate filter-title" data-action="toggle"></span>\n			</div>\n		</li>\n		<li role="menuitem">\n			<div class="filter-cc-menu ui-dropdown ui-dropdown-closed ui-unselectable-text">\n				<span class="truncate filter-title" data-action="toggle"></span>\n				<span class="ui-dialog-arrow"></span>\n				<ul class="filter-submenu" role="menu">\n					<li role="menuitem" data-track="searchFilterLicenseAll" data-action="set" data-value="all" data-text="',s={hash:{intlName:"filter-bar.ANY_LICENSE"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):c.call(e,"intlMessage",s)))+' &nbsp;\u25be">',s={hash:{intlName:"filter-bar.ANY_LICENSE"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):c.call(e,"intlMessage",s)))+'</li>\n					<li role="menuitem" data-track="searchFilterLicenseCCOnly" data-action="set" data-value="cc" data-text="',s={hash:{intlName:"filter-bar.CC_LICENSE_PARENT"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):c.call(e,"intlMessage",s)))+' &nbsp;\u25be">',s={hash:{intlName:"filter-bar.CC_LICENSE"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):c.call(e,"intlMessage",s)))+'</li>\n					<li role="menuitem" data-track="searchFilterLicenseCCCommericialUse" data-action="set" data-value="cc-comm" data-sub="cc" data-text="',s={hash:{intlName:"filter-bar.CC_LICENSE_PARENT"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):c.call(e,"intlMessage",s)))+' &nbsp;\u25be">',s={hash:{intlName:"filter-bar.COMM_LICENSE"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):c.call(e,"intlMessage",s)))+'</li>\n					<li role="menuitem" data-track="searchFilterLicenseCCModifyAdaptBuild" data-action="set" data-value="cc-deriv" data-sub="cc" data-text="',s={hash:{intlName:"filter-bar.CC_LICENSE_PARENT"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):c.call(e,"intlMessage",s)))+' &nbsp;\u25be">',s={hash:{intlName:"filter-bar.DERIV_LICENSE"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):c.call(e,"intlMessage",s)))+"</li>\n				</ul>\n			</div>\n		</li>\n		",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f="function",l=this.escapeExpression,c=n.helperMissing,h=this;a={hash:{},inverse:h.noop,fn:h.program(1,p,i),data:i},u=(o=n.isFlipped||t.isFlipped,o?o.call(t,t.flippers,"opt-out-reboot-unified-search",a):c.call(t,"isFlipped",t.flippers,"opt-out-reboot-unified-search",a));if(
u||u===0)s+=u;s+='\n<div class="filter-bar-content">\n\n	<ul class="filter-menu" role="menubar">\n		<li role="menuitem">\n			<div class="filter-sort-label ui-togglebutton ui-togglebutton-icon ui-unselectable-text" data-label="',a={hash:{intlName:"filter-bar.SORT_BY"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+':" data-labeltoggled="',a={hash:{intlName:"filter-bar.SORT_BY"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+':">\n				<span class="truncate filter-title" data-action="toggle"></span>\n			</div>\n		</li>\n		<li role="menuitem">\n			<div class="ui-dropdown ui-dropdown-closed ui-unselectable-text filter-sort-menu">\n				<span class="truncate filter-title" data-action="toggle"></span>\n				<span class="ui-dialog-arrow"></span>\n				<ul class="filter-submenu" role="menu">\n					<li role="menuitem" data-track="searchFilterSortRelevanceClick" data-action="set" data-value="relevance" data-text="',a={hash:{intlName:"filter-bar.RELEVANT"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+' &nbsp;\u25be">',a={hash:{intlName:"filter-bar.RELEVANT"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+'</li>\n					<li role="menuitem" data-track="searchFilterSortRecentClick" data-action="set" data-value="date-posted-desc" data-text="',a={hash:{intlName:"filter-bar.RECENT"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+' &nbsp;\u25be">',a={hash:{intlName:"filter-bar.RECENT"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+'</li>\n					<li role="menuitem" data-track="searchFilterSortInterestingClick" data-action="set" data-value="interestingness-desc" data-text="',a={hash:{intlName:"filter-bar.INTERESTING"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+' &nbsp;\u25be">',a={hash:{intlName:"filter-bar.INTERESTING"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+'</li>\n				</ul>\n			</div>\n		</li>\n		<li role="menuitem">\n			<div class="filter-search-label ui-togglebutton ui-togglebutton-icon ui-unselectable-text" data-label="',a={hash:{intlName:"filter-bar.SEARCH_IN"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+':" data-labeltoggled="',a={hash:{intlName:"filter-bar.SEARCH_IN"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+':">\n				<span class="truncate filter-title" data-action="toggle"></span>\n			</div>\n		</li>\n		<li role="menuitem">\n			<div class="search-scope-menu ui-dropdown ui-dropdown-closed ui-unselectable-text ui-dropdown-ellipsis">\n				<span class="truncate filter-title" data-action="toggle"></span>\n				<span class="ui-dialog-arrow"></span>\n				<ul class="filter-submenu" role="menu">\n					<li role="menuitem" data-track="searchFilterScopeEveryoneClick" data-action="set" data-value="0" data-text="',a={hash:{intlName:"filter-bar.EVERYONE"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+' &nbsp;\u25be">',a={hash:{intlName:"filter-bar.EVERYONE"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+"</li>\n\n					",u=n["if"].call(t,(o=t.viewer,o==null||o===!1?o:o.signedIn),{hash:{},inverse:h.noop,fn:h.program(3,d,i),data:i});if(u||u===0)s+=u;s+="\n\n					",u=n["if"].call(t,t.showUserOption,{hash:{},inverse:h.noop,fn:h.program(5,v,i),data:i});if(u||u===0)s+=u;s+="\n\n					",u=n["if"].call(t,t.groupModel,{hash:{},inverse:h.noop,fn:h.program(7,m,i),data:i});if(u||u===0)s+=u;s+='\n\n					<li role="menuitem" data-track="searchFilterScopeUsersClick" data-action="set" data-value="5" data-text="',a={hash:{intlName:"filter-bar.PEOPLE"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+' &nbsp;\u25be">',a={hash:{intlName:"filter-bar.PEOPLE"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+'</li>\n					<li role="menuitem" data-track="searchFilterScopeGroupsClick" data-action="set" data-value="6" data-text="',a={hash:{intlName:"filter-bar.GROUPS"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+' &nbsp;\u25be">',a={hash:{intlName:"filter-bar.GROUPS"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+"</li>\n				</ul>\n			</div>\n		</li>\n		",a={hash:{},inverse:h.noop,fn:h.program(9,g,i),data:i},u=(o=n.isFlipped||t.isFlipped,o?o.call(t,t.flippers,"enable-license-search",a):c.call(t,"isFlipped",t.flippers,"enable-license-search",a));if(u||u===0)s+=u;return s+='\n		<li role="menuitem" class="filter-bar-right">\n			<a href="/search/advanced/',(u=n.advancedSearchQueryStr)?u=u.call(t,{hash:{},data:i}):(u=t.advancedSearchQueryStr,u=typeof u===f?u.apply(t):u),s+=l(u)+'">',a={hash:{intlName:"filter-bar.ADVANCED_SEARCH"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+"</a>\n		</li>\n	</ul>\n\n</div>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/filter-bar-neutered",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("filter-bar-neutered-view",function(e){var t;t={css:{sortMenu:".filter-sort-menu",sortLabel:".filter-sort-label",searchScopeMenu:".search-scope-menu",searchLabel:".filter-search-label",ccLabel:".filter-cc-label",ccMenu:".filter-cc-menu"}},e.namespace("Views")[this.name]=e.Base.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.searchId=e.searchId,this.apiParams={},this.elementStates=this.setElementStates(e),this},subviewConfig:{},loadState:function(){var t=this,n,r,i=t.appContext.getViewer();return this.searchId?n=this.appContext.getModel("search-photos-models",this.searchId).then(function(n){var r=n.getValue("apiParams"),i,s=null,o=null;return t.searchModel=n,r.group_id?(i={},e.TypeValidator.matches.nsid(r.group_id)?i.id=r.group_id:i.pathAlias=r.group_id,s=t.appContext.getModel("group-pool-models",i)):s=e.Promise.resolve(),r.user_id?(i={},e.TypeValidator.matches.nsid(r.user_id)?i.id=r.user_id:i.pathAlias=r.user_id,o=t.appContext.getModel("person-models",i)):o=e.Promise.resolve(),e.Promise.all([s,o]).then(function(e){e[0]&&(t.groupModel=e[0]),e[1]&&(t.personModel=e[1])})}):n=e.Promise.resolve(),i.signedIn?r=t.appContext.getModel("person-preferences-models",i.nsid).then(function(e){t.personPreferencesModel=e}):r=e.Promise.resolve(),e.Promise.all([n,r]).then(function(){t.searchModel?t.apiParams=t.searchModel.getValue("apiParams"):e.SearchHelper.addParamDefaults(t.apiParams,t.personPreferencesModel)})},buildContainer:function(){var e="",t;return this.searchModel&&(e=this.generateAdvancedSearchQuery(this.searchModel.getValue("apiParams"))),YUI.Env.isServer?t=this.appContext.request.url:t=window.location.pathname,this.setContainerHTML(this.templates("filter-bar-neutered")({elements:this.elementStates,advancedSearchQueryStr:e,viewer:this.appContext.getViewer(),showUserOption:this.personModel&&this.personModel.getValue("nsid")!==this.appContext.getViewer().nsid,personModel:this.personModel&&this.personModel.toJSON(),groupModel:this.groupModel&&this.groupModel.toJSON(),flippers:this.appContext.flipper.toJSON(),csrf:this.appContext.auth.csrf?this.appContext.auth.csrf:"",pageUrl:t})),this},activate:function(){var n=this,r=this.appContext.getViewer(),i,s;return this.filterViews={},this.elementStates.searchScope&&(s=this.getSearchScopeState(this.apiParams,r,this.personModel),this.filterViews.searchLabel=this.createLabelButton(t.css.searchLabel),this.filterViews.searchScope=this.createSimpleDropdown(t.css.searchScopeMenu,s),this.registerEventHandler(this.filterViews.searchScope.on("selected",function(t){var r=e.clone(n.apiParams),i="/search/?";delete r.user_id,delete r.group_id,delete r.contacts;switch(t.clicked.value){case"1":r.user_id=n.appContext.getViewer().nsid;break;case"2":r.contacts="all";break;case"3":r.user_id=t.clicked.itemEl.getData("nsid");break;case"4":r.group_id=t.clicked.itemEl.getData("nsid");break;case"5":i="/search/people/?",r={q:n.apiParams.q||n.apiParams.text||n.apiParams.tags},n.classicNavigate(i+e.QueryString.stringify(r));break;case"6":i="/search/groups/?",r={q:n.apiParams.q||n.apiParams.text||n.apiParams.tags},n.classicNavigate(i+e.QueryString.stringify(r))}e.SearchHelper.addParamDefaults(r,n.personPreferencesModel),n.navigate(i+e.QueryString.stringify(r))})),this.bindOpenEvent(this.filterViews.searchScope)),this.elementStates.sort&&(this.filterViews.sortLabel=this.createLabelButton(t.css.sortLabel),s=this.apiParams[e.SearchHelper.API.sort],this.filterViews.sort=this.createSimpleDropdown(t.css.sortMenu,s),this.bindSelectedEvent(this.filterViews.sort,e.SearchHelper.API.sort),this.bindOpenEvent(this.filterViews.sort)),this.elementStates.license&&(this.filterViews.ccLabel=this.createLabelButton(t.css.ccLabel),s=this.determineLicenseForUI(this.apiParams[e.SearchHelper.API.license]||"all"),this.filterViews.creativeCommons=new e.Views.Dropdown({appContext:this.appContext,container:this.get("container").one(t.css.ccMenu),selected:s,hasDialogArrow:!0,useCheckMarks:!0,multiSelect:!1,multiSelectSub:!0,selectParent:!0,minimumSelected:1,shouldCreateShim:!1,autoSizeMenu:!1}),this.bindSelectedEvent(this.filterViews.creativeCommons,e.SearchHelper.API.license),this.bindOpenEvent(this.filterViews.creativeCommons)),i=this.get("container").one("#optin"),i&&this.registerEventHandler(i.on("submit",function(t){t.preventDefault(),e.use("opt-outer",function(e){e.optIn("reboot-unified-search"),i.submit()})})),n},getSearchScopeState:function(e,t,n){var r=0;return e.user_id&&e.group_id?t.signedIn&&n&&n.getValue("nsid")===t.nsid?r=1:r=3:t.signedIn&&e.group_id&&e.contacts?r=2:e.user_id?t.signedIn&&n&&n.getValue("nsid")===t.nsid?r=1:r=3:e.contacts?r=2:e.group_id&&(r=4),r},determineLicenseForAPI:function(t){var n,r=t.indexOf("all")>=0,i=t.indexOf("cc")>=0,s=t.indexOf("cc-comm")>=0,o=t.indexOf("cc-deriv")>=0;return r?n=e.SearchHelper.LICENSE_TYPE.all:i&&s&&o?n=e.SearchHelper.LICENSE_TYPE.commderiv:i&&s?n=e.SearchHelper.LICENSE_TYPE.comm:i&&o?n=e.SearchHelper.LICENSE_TYPE.deriv:i&&(n=e.SearchHelper.LICENSE_TYPE.cc),n},determineLicenseForUI:function(t){var n;switch(t){case e.SearchHelper.LICENSE_TYPE.commderiv:n=["cc","cc-comm","cc-deriv"];break;case e.SearchHelper.LICENSE_TYPE.comm:n=["cc","cc-comm"];break;case e.SearchHelper.LICENSE_TYPE.deriv:n=["cc","cc-deriv"];break;case e.SearchHelper.LICENSE_TYPE.cc:n=["cc"];break;default:n=["all"]}return n},classicNavigate:function(t){window.location=e.url(t)},createSimpleDropdown:function(t,n){return new e.Views.Dropdown({appContext:this.appContext,container:this.get("container").one(t),selected:n,useCheckMarks:!0,shouldCreateShim:!1,autoSizeMenu:!1})},createLabelButton:function(t){return new e.Views.ToggleButton({appContext:this.appContext,container:this.get("container").one(t)})},bindSelectedEvent:function(t,n){var r=this;this.registerEventHandler(t.on("selected",function(t){var i=r.apiParams,s={};n==="license"?s[n]=r.determineLicenseForAPI(t.selections):s[n]=t.clicked.value,i=e.merge(i,s),e.SearchHelper
.addParamDefaults(i,r.personPreferencesModel),!t.data||!t.data.track?r.appContext.warn("No data-track attribute found on clicked element. Not beaconing."):e.rapidTracker.beacon(r.name,t.data.track),r.navigate("/search/?"+e.QueryString.stringify(i))}))},navigate:function(e){e&&(this.fire("navigating"),this.appContext.flapp.navigate(e))},bindOpenEvent:function(t){var n=this;this.registerEventHandler(t.on("open",function(t){n.openDropdown&&n.openDropdown.close(),n.openDropdown=t.target,n.registerEventHandler(e.one("body").once("click",function(){n.openDropdown&&n.openDropdown.close()}))})),this.registerEventHandler(t.on("close",function(e){n.openDropdown=null}))},setElementStates:function(e){var t={searchScope:!0,sort:!0,license:this.appContext.flipper.isFlipped("enable-license-search")};return t},generateAdvancedSearchQuery:function(t){var n=e.SearchHelper.mapAPIParamsToAdvancedSearchQuery(t);return t.q&&(n.q=t.q),"?"+e.QueryString.stringify(n)},destructor:function(){var e;for(e in this.filterViews)this.filterViews[e].destroy()}})},"@VERSION@",{requires:["flickrui-css","dropdown","togglebutton","flickr-view","flickr-promise","person-models","group-pool-models","search-photos-models","search-helper","hermes-template-filter-bar-neutered","filter-bar-neutered-css","url"],langBundles:["filter-bar","search"]});
YUI.add("hermes-lang-filter-bar",function(e,t){e.Intl.add("hermes/filter-bar","en-US",{EVERYONE:["Everyone's Photos"],YOUR_PHOTOS:["Your Photos"],CONTACTS_PHOTOS:["Your Contacts' Photos"],USER_PHOTOS:["${name}","'s Photos"],GROUP_PHOTOS:["Photos in ","${name}"],PEOPLE:["People"],GROUPS:["Groups"],USER_PHOTOS_IN_GROUP:["${name}","'s Photos in ","${group}"],YOUR_PHOTOS_IN_GROUP:["Your Photos in ","${group}"],CONTACTS_PHOTOS_IN_GROUP:["Your Contacts' Photos in ","${group}"],YOUR_FAVORITES:["Your Favorites"],MORE:["More"],LESS:["Less"],PHOTOS_VIDEOS:["Photos & Videos"],ONLY_PHOTOS:["Only Photos"],ONLY_VIDEOS:["Only Videos"],ALL_TIME:["All Time"],DATE_TAKEN:["Date Taken"],DATE_POSTED:["Date Posted"],FROM:["From"],TO:["To"],MONTH_CHARS:["mm"],DAY_CHARS:["dd"],YEAR_CHARS:["yyyy"],DATE_INVALID:["Date invalid"],DONE:["Done"],DATE:["Date"],LICENSE:["License"],ANY_LICENSE:["Any License"],CC_LICENSE:["Creative Commons only"],CC_LICENSE_PARENT:["Creative Commons"],COMM_LICENSE:["Commercial use allowed"],DERIV_LICENSE:["Modifications allowed"],SS_ON:["SafeSearch on"],ON:["On"],SS_MOD:["SafeSearch moderate"],MOD:["Moderate"],SS_OFF:["SafeSearch off"],OFF:["Off"],RELEVANT:["Relevant"],RECENT:["Recent"],INTERESTING:["Interesting"],SORT_BY:["Sort"],SEARCH_IN:["Search"],ADVANCED_SEARCH:["Advanced Search"]})},"@VERSION@",{requires:["intl"]});
YUI.add("search-photos-page-view",function(e){e.namespace("Views")[this.name]=e.Base.create("search-photos-page-view",e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){this.searchId=t.searchId,this.apiParams={},this.searchTerm=t.searchTerm,this.apiFailed=t.apiFailed;var n=this.name.replace(/-/g,"_");return this.appContext.flipper.isFlipped("paft")&&e.config.flickr.paft_metrics_samples&&e.config.flickr.paft_metrics_samples[n]&&(t.paft=!0),this},subviewConfig:{"global-nav-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0,isSearchResults:!0},"filter-bar-neutered-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0},"search-photos-collection-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0},"footer-full-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0}},loadState:function(){var t=this,n,r,i=this.appContext.getViewer(),s;return i.signedIn?r=this.appContext.getModel("person-preferences-models",i.nsid):r=e.Promise.resolve(),this.apiFailed?n=e.Promise.resolve():n=this.appContext.getModel("search-photos-models",this.searchId),s=e.Promise.all([r,n]),s.then(function(n){n[0]&&(t.personPreferencesModel=n[0]),n[1]?(t.searchModel=n[1],t.apiParams=t.searchModel.getValue("apiParams")):e.SearchHelper.addParamDefaults(t.apiParams,t.personPreferencesModel)}),s},additionalViewClasses:function(){var e=[];return this.appContext.flipper.isFlipped("opt-out-reboot-unified-search")&&e.push("enable-search-optin"),e},buildContainer:function(){var e="",t="",n="",r={apiFailed:!1,noQuery:!1,noMatchesForQuery:!1},i,s,o;return this.apiFailed?(r.apiFailed=!0,s=this.intlMessage({intlName:"search.SEARCH"}),t=this.subviews["filter-bar-neutered-view"].get("container"),n=this.subviews["footer-full-view"].get("container")):this.searchModel.getValue("photos").getList().length?(e=this.subviews["search-photos-collection-view"].get("container"),t=this.subviews["filter-bar-neutered-view"].get("container"),n=this.subviews["footer-full-view"].get("container")):this.searchModel.getValue("emptyQuery")?(r.noQuery=!0,s=this.intlMessage({intlName:"search.SEARCH_START"}),i=this.intlMessage({intlName:"search.BY_USER",user:"Gilles Couturier"})):(r.noMatchesForQuery=this.buildNoMatchesFoundMessage(),s=this.intlMessage({intlName:"search.SEARCH"}),t=this.subviews["filter-bar-neutered-view"].get("container"),n=this.subviews["footer-full-view"].get("container")),o={"global-nav-view":this.subviews["global-nav-view"].get("container"),"filter-bar-neutered-view":t,"search-photos-collection-view":e,searchState:r,searchPlaceholder:s,flippers:this.appContext.flipper.toJSON(),"footer-full-view":n,attribution:{link:"/photos/papy06/11384700923",by:i}},this.setContainerHTML(this.templates("search-photos-page")(o)),this},buildNoMatchesFoundMessage:function(){var t,n,r,i=this.appContext.getViewer();return n=this.searchModel.getValue("apiParams"),n.user_id?i.signedIn&&n.user_id===i.nsid?this.searchTerm?r="search.NO_MATCHES_FOR_QUERY_TERM_CONTEXT_YOUR":r="search.NO_MATCHES_FOR_QUERY_TERM_YOUR":this.searchTerm?r="search.NO_MATCHES_FOR_QUERY_TERM_CONTEXT_USER":r="search.NO_MATCHES_FOR_QUERY_TERM_USER":n.contacts?this.searchTerm?r="search.NO_MATCHES_FOR_QUERY_TERM_CONTEXT_CONTACTS":r="search.NO_MATCHES_FOR_QUERY_TERM_CONTACTS":n.group_id?this.searchTerm?r="search.NO_MATCHES_FOR_QUERY_TERM_CONTEXT_GROUP":r="search.NO_MATCHES_FOR_QUERY_TERM_GROUP":this.searchTerm?r="search.NO_MATCHES_FOR_QUERY_TERM":r="search.NO_MATCHES_FOR_QUERY",this.searchTerm?t=this.intlMessage({intlName:r,searchTerm:e.flutil.unescape(this.searchTerm)}):t=this.intlMessage({intlName:r}),{noMatchesText:t}},activate:function(){var t=this,n;return this.registerEventHandler(this.subviews["filter-bar-neutered-view"].on("navigating",function(){var e=t.subviews["search-photos-collection-view"];e&&e.displayLoadingIndicator("searching")})),n=this.get("container").one("form.ui-large-search"),n&&this.registerEventHandler(n.on("submit",function(n){delete t.apiParams[e.SearchHelper.API.tags],t.apiParams[e.SearchHelper.API.text]=this.one("input").get("value"),e.SearchHelper.clearAdvancedSearchParams(t.apiParams),e.SearchHelper.addParamDefaults(t.apiParams,t.personPreferencesModel),t.appContext.flapp.navigate("/search/?"+e.QueryString.stringify(t.apiParams)),n.preventDefault()})),e.later(100,this,function(){e.use("photo-page-scrappy-view")}),this}},{ATTRS:{spaceid:{value:792600534}}})},"@VERSION@",{requires:["flutil","flickr-view","flickr-promise","search-helper","hermes-template-search-photos-page","search-photos-page-css","search-photos-collection-view","display-collection-justified","flickrui-css","footer-full-view","filter-bar-neutered-view","querystring-stringify-simple"],optional:["search-photos-models"],langBundles:["search"]});
YUI.add("hermes-lang-client-app",function(e,t){e.Intl.add("hermes/client-app","en-US",{SAVING_LAST_ACTIONS:["Hey! We\u2019re still saving your last actions, you might lose them if you leave this page."]})},"@VERSION@",{requires:["intl"]});
